<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book Tracker - –£—á–µ—Ç –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö –∫–Ω–∏–≥</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* –ù–∞–≤–∏–≥–∞—Ü–∏—è */
        nav {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 15px 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.5em;
            font-weight: bold;
            color: #2c3e50;
        }
        
        .logo span {
            font-size: 1.8em;
        }
        
        .nav-links {
            display: flex;
            gap: 20px;
            align-items: center;
        }
        
        .nav-links a {
            text-decoration: none;
            color: #2c3e50;
            font-weight: 500;
            padding: 10px 20px;
            border-radius: 8px;
            transition: all 0.3s;
        }
        
        .nav-links a:hover {
            background: #3498db;
            color: white;
        }
        
        #logout-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: background 0.3s;
        }
        
        #logout-btn:hover {
            background: #c0392b;
        }
        
        /* –ì–µ—Ä–æ–π —Å–µ–∫—Ü–∏—è */
        .hero {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 60px;
            text-align: center;
            margin-bottom: 40px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .hero h1 {
            font-size: 3em;
            color: #2c3e50;
            margin-bottom: 20px;
        }
        
        .hero p {
            font-size: 1.2em;
            color: #7f8c8d;
            max-width: 800px;
            margin: 0 auto 30px;
            line-height: 1.6;
        }
        
        .cta-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-top: 30px;
        }
        
        .btn {
            padding: 15px 30px;
            border-radius: 10px;
            text-decoration: none;
            font-weight: bold;
            font-size: 1.1em;
            transition: all 0.3s;
            border: none;
            cursor: pointer;
        }
        
        .btn-primary {
            background: #3498db;
            color: white;
        }
        
        .btn-primary:hover {
            background: #2980b9;
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(52, 152, 219, 0.3);
        }
        
        .btn-secondary {
            background: #2ecc71;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #27ae60;
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(46, 204, 113, 0.3);
        }
        
        /* –°–µ–∫—Ü–∏–∏ */
        .section {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .section h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 2em;
        }
        
        /* –§–æ—Ä–º–∞ –ª–æ–≥–∏–Ω–∞/—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ */
        .auth-container {
            background: rgba(255, 255, 255, 0.98);
            border-radius: 20px;
            padding: 40px;
            max-width: 500px;
            margin: 0 auto;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #2c3e50;
            font-weight: 500;
        }
        
        .form-group input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        .form-group input:focus {
            outline: none;
            border-color: #3498db;
        }
        
        /* –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ */
        .app-container {
            display: grid;
            grid-template-columns: 250px 1fr;
            gap: 30px;
            min-height: 600px;
        }
        
        .sidebar {
            background: rgba(52, 73, 94, 0.95);
            border-radius: 15px;
            padding: 30px;
            color: white;
        }
        
        .main-content {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 30px;
        }
        
        .book-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            border: 1px solid #e0e0e0;
        }
        
        .progress-bar {
            background: #ecf0f1;
            border-radius: 10px;
            height: 10px;
            margin: 10px 0;
            overflow: hidden;
        }
        
        .progress-fill {
            background: #2ecc71;
            height: 100%;
            transition: width 0.3s;
        }
        
        /* –°–æ–æ–±—â–µ–Ω–∏—è */
        .message {
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            font-weight: 500;
        }
        
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .hidden {
            display: none !important;
        }
        
        /* –§—É—Ç–µ—Ä */
        footer {
            text-align: center;
            padding: 30px;
            color: white;
            margin-top: 50px;
        }
        
        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 768px) {
            .app-container {
                grid-template-columns: 1fr;
            }
            
            nav {
                flex-direction: column;
                gap: 15px;
            }
            
            .hero h1 {
                font-size: 2em;
            }
            
            .cta-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
        <nav>
            <div class="logo">
                <span>üìö</span>
                Book Tracker
            </div>
            <div class="nav-links">
                <a href="#" id="home-link">–ì–ª–∞–≤–Ω–∞—è</a>
                <a href="#" id="about-link">–û –ø—Ä–æ–µ–∫—Ç–µ</a>
                <a href="#" id="app-link">–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</a>
                <a href="#" id="docs-link">–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è</a>
                <button id="logout-btn" class="hidden">üö™ –í—ã–π—Ç–∏</button>
            </div>
        </nav>
        
        <!-- –ì–ª–∞–≤–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
        <div id="main-content">
            <!-- –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π —ç–∫—Ä–∞–Ω (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∫–æ–≥–¥–∞ –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω) -->
            <div id="welcome-screen">
                <div class="hero">
                    <h1>üìö –£—á–µ—Ç –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö –∫–Ω–∏–≥</h1>
                    <p>–û—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ —Å–≤–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å –≤ —á—Ç–µ–Ω–∏–∏, –¥–æ–±–∞–≤–ª—è–π—Ç–µ —Ä–µ—Ü–µ–Ω–∑–∏–∏ –∏ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –∑–∞–±—ã–≤–∞–π—Ç–µ, –Ω–∞ –∫–∞–∫–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ –≤—ã –æ—Å—Ç–∞–Ω–æ–≤–∏–ª–∏—Å—å. –í–∞—à–∞ –ª–∏—á–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –≤—Å–µ–≥–¥–∞ —Å –≤–∞–º–∏.</p>
                    
                    <div id="auth-buttons" class="cta-buttons">
                        <button class="btn btn-primary" onclick="showLogin()">–í–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É</button>
                        <button class="btn btn-secondary" onclick="showRegister()">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
                    </div>
                </div>
                
                <div class="section">
                    <h2>‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏</h2>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-top: 20px;">
                        <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                            <h3 style="color: #3498db;">üìñ –£—á–µ—Ç –∫–Ω–∏–≥</h3>
                            <p>–î–æ–±–∞–≤–ª—è–π—Ç–µ –∫–Ω–∏–≥–∏ –≤ —Å–≤–æ—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É, –æ—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ –∏ –ø–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ.</p>
                        </div>
                        <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                            <h3 style="color: #2ecc71;">üìä –ü—Ä–æ–≥—Ä–µ—Å—Å</h3>
                            <p>–û—Ç–º–µ—á–∞–π—Ç–µ —Ç–µ–∫—É—â—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏ —Å–ª–µ–¥–∏—Ç–µ –∑–∞ —Å–≤–æ–∏–º –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.</p>
                        </div>
                        <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                            <h3 style="color: #9b59b6;">‚≠ê –†–µ—Ü–µ–Ω–∑–∏–∏</h3>
                            <p>–û—Å—Ç–∞–≤–ª—è–π—Ç–µ –æ—Ç–∑—ã–≤—ã –∏ –æ—Ü–µ–Ω–∫–∏ –∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–º –∫–Ω–∏–≥–∞–º.</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- –§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞ -->
            <div id="login-form" class="auth-container hidden">
                <h2>–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É</h2>
                <div class="form-group">
                    <label for="login-username">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
                    <input type="text" id="login-username" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –ª–æ–≥–∏–Ω">
                </div>
                <div class="form-group">
                    <label for="login-password">–ü–∞—Ä–æ–ª—å</label>
                    <input type="password" id="login-password" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –ø–∞—Ä–æ–ª—å">
                </div>
                <div id="login-message" class="message hidden"></div>
                <button class="btn btn-primary" onclick="performLogin()" style="width: 100%;">–í–æ–π—Ç–∏</button>
                <button class="btn" onclick="showWelcome()" style="width: 100%; margin-top: 10px; background: #95a5a6;">–ù–∞–∑–∞–¥</button>
            </div>
            
            <!-- –§–æ—Ä–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
            <div id="register-form" class="auth-container hidden">
                <h2>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
                <div class="form-group">
                    <label for="register-username">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
                    <input type="text" id="register-username" placeholder="–ü—Ä–∏–¥—É–º–∞–π—Ç–µ –ª–æ–≥–∏–Ω">
                </div>
                <div class="form-group">
                    <label for="register-email">Email</label>
                    <input type="email" id="register-email" placeholder="–í–≤–µ–¥–∏—Ç–µ email">
                </div>
                <div class="form-group">
                    <label for="register-password">–ü–∞—Ä–æ–ª—å</label>
                    <input type="password" id="register-password" placeholder="–ü—Ä–∏–¥—É–º–∞–π—Ç–µ –ø–∞—Ä–æ–ª—å">
                </div>
                <div id="register-message" class="message hidden"></div>
                <button class="btn btn-secondary" onclick="performRegister()" style="width: 100%;">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
                <button class="btn" onclick="showWelcome()" style="width: 100%; margin-top: 10px; background: #95a5a6;">–ù–∞–∑–∞–¥</button>
            </div>
            
            <!-- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –≤—Ö–æ–¥–∞) -->
            <div id="app-screen" class="hidden">
                <div class="app-container">
                    <div class="sidebar">
                        <h3 style="color: white; margin-bottom: 20px;">üë§ <span id="current-user-name"></span></h3>
                        <div style="margin-bottom: 30px;">
                            <button onclick="showAddBookForm()" style="width: 100%; padding: 12px; background: #3498db; color: white; border: none; border-radius: 8px; cursor: pointer; margin-bottom: 10px;">
                                ‚ûï –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–∏–≥—É
                            </button>
                            <button onclick="loadBooks()" style="width: 100%; padding: 12px; background: #2ecc71; color: white; border: none; border-radius: 8px; cursor: pointer;">
                                üîÑ –û–±–Ω–æ–≤–∏—Ç—å –∫–Ω–∏–≥–∏
                            </button>
                        </div>
                        <div style="margin-top: 30px;">
                            <p style="color: #bdc3c7; font-size: 14px;">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:</p>
                            <p style="color: white; font-weight: bold;" id="books-count">–ö–Ω–∏–≥: 0</p>
                            <p style="color: white; font-weight: bold;" id="pages-read">–ü—Ä–æ—á–∏—Ç–∞–Ω–æ —Å—Ç—Ä–∞–Ω–∏—Ü: 0</p>
                        </div>
                    </div>
                    
                    <div class="main-content">
                        <h2>–ú–æ–∏ –∫–Ω–∏–≥–∏</h2>
                        <div id="books-list"></div>
                        
                        <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–Ω–∏–≥–∏ -->
                        <div id="add-book-modal" class="hidden" style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin-top: 20px;">
                            <h3>–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –∫–Ω–∏–≥—É</h3>
                            <div class="form-group">
                                <input type="text" id="new-book-title" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∫–Ω–∏–≥–∏">
                            </div>
                            <div class="form-group">
                                <input type="text" id="new-book-author" placeholder="–ê–≤—Ç–æ—Ä">
                            </div>
                            <div class="form-group">
                                <textarea id="new-book-description" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ" rows="3"></textarea>
                            </div>
                            <div class="form-group">
                                <input type="number" id="new-book-pages" placeholder="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–∞–Ω–∏—Ü">
                            </div>
                            <div style="display: flex; gap: 10px;">
                                <button class="btn btn-primary" onclick="addNewBook()">–î–æ–±–∞–≤–∏—Ç—å</button>
                                <button class="btn" onclick="hideAddBookForm()" style="background: #95a5a6;">–û—Ç–º–µ–Ω–∞</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- –§—É—Ç–µ—Ä -->
        <footer>
            <p>¬© 2024 Book Tracker ‚Ä¢ –°–µ—Ä–≤–∏—Å –¥–ª—è —É—á–µ—Ç–∞ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö –∫–Ω–∏–≥</p>
            <p style="margin-top: 10px; opacity: 0.8; font-size: 14px;">
                API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: <a href="/docs" style="color: #3498db; text-decoration: none;">/docs</a> | 
                OpenAPI —Å—Ö–µ–º–∞: <a href="/openapi.json" style="color: #3498db; text-decoration: none;">/openapi.json</a>
            </p>
        </footer>
    </div>

    <script>
        const API_BASE = window.location.origin;
        let currentToken = localStorage.getItem('bookTrackerToken') || '';
        let currentUsername = localStorage.getItem('bookTrackerUsername') || '';
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', function() {
            if (currentToken && currentUsername) {
                // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
                showApp();
            } else {
                // –ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π —ç–∫—Ä–∞–Ω
                showWelcome();
            }
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
            document.getElementById('home-link').addEventListener('click', function(e) {
                e.preventDefault();
                if (currentToken) {
                    showApp();
                } else {
                    showWelcome();
                }
            });
            
            document.getElementById('app-link').addEventListener('click', function(e) {
                e.preventDefault();
                if (currentToken) {
                    showApp();
                } else {
                    showLogin();
                }
            });
            
            document.getElementById('docs-link').addEventListener('click', function(e) {
                e.preventDefault();
                window.open('/docs', '_blank');
            });
            
            document.getElementById('logout-btn').addEventListener('click', logout);
            
            document.getElementById('about-link').addEventListener('click', function(e) {
                e.preventDefault();
                alert('Book Tracker - —ç—Ç–æ —Å–µ—Ä–≤–∏—Å –¥–ª—è —É—á–µ—Ç–∞ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö –∫–Ω–∏–≥ —Å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∏ —Ä–µ—Ü–µ–Ω–∑–∏—è–º–∏. –†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º FastAPI –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –≤–µ–±-—Å—Ç—ç–∫–∞.');
            });
        });
        
        // –§—É–Ω–∫—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —ç–∫—Ä–∞–Ω–∞–º–∏
        function showWelcome() {
            hideAllScreens();
            document.getElementById('welcome-screen').classList.remove('hidden');
            document.getElementById('logout-btn').classList.add('hidden');
        }
        
        function showLogin() {
            hideAllScreens();
            document.getElementById('login-form').classList.remove('hidden');
            document.getElementById('logout-btn').classList.add('hidden');
        }
        
        function showRegister() {
            hideAllScreens();
            document.getElementById('register-form').classList.remove('hidden');
            document.getElementById('logout-btn').classList.add('hidden');
        }
        
        function showApp() {
            if (!currentToken) {
                showLogin();
                return;
            }
            
            hideAllScreens();
            document.getElementById('app-screen').classList.remove('hidden');
            document.getElementById('logout-btn').classList.remove('hidden');
            document.getElementById('current-user-name').textContent = currentUsername;
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–Ω–∏–≥–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            loadBooks();
        }
        
        function hideAllScreens() {
            document.getElementById('welcome-screen').classList.add('hidden');
            document.getElementById('login-form').classList.add('hidden');
            document.getElementById('register-form').classList.add('hidden');
            document.getElementById('app-screen').classList.add('hidden');
            document.getElementById('add-book-modal').classList.add('hidden');
        }
        
        // –§—É–Ω–∫—Ü–∏—è –≤—Ö–æ–¥–∞
        async function performLogin() {
            const username = document.getElementById('login-username').value;
            const password = document.getElementById('login-password').value;
            const messageDiv = document.getElementById('login-message');
            
            if (!username || !password) {
                showMessage(messageDiv, '–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω –∏ –ø–∞—Ä–æ–ª—å', 'error');
                return;
            }
            
            try {
                const response = await fetch(`${API_BASE}/login`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ username, password })
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    currentToken = data.access_token;
                    currentUsername = username;
                    
                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
                    localStorage.setItem('bookTrackerToken', currentToken);
                    localStorage.setItem('bookTrackerUsername', username);
                    
                    showMessage(messageDiv, '–£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥!', 'success');
                    setTimeout(() => showApp(), 1000);
                } else {
                    showMessage(messageDiv, data.detail || '–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞', 'error');
                }
            } catch (error) {
                showMessage(messageDiv, '–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É', 'error');
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
        async function performRegister() {
            const username = document.getElementById('register-username').value;
            const email = document.getElementById('register-email').value;
            const password = document.getElementById('register-password').value;
            const messageDiv = document.getElementById('register-message');
            
            if (!username || !email || !password) {
                showMessage(messageDiv, '–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è', 'error');
                return;
            }
            
            try {
                const response = await fetch(`${API_BASE}/register`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ username, email, password })
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    showMessage(messageDiv, '–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞! –¢–µ–ø–µ—Ä—å –≤–æ–π–¥–∏—Ç–µ.', 'success');
                    setTimeout(() => {
                        document.getElementById('login-username').value = username;
                        document.getElementById('login-password').value = '';
                        showLogin();
                    }, 1500);
                } else {
                    showMessage(messageDiv, data.detail || '–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏', 'error');
                }
            } catch (error) {
                showMessage(messageDiv, '–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É', 'error');
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –≤—ã—Ö–æ–¥–∞
        async function logout() {
            if (!currentToken) return;
            
            try {
                await fetch(`${API_BASE}/logout`, {
                    method: 'POST',
                    headers: { 
                        'Authorization': `Bearer ${currentToken}`,
                        'Content-Type': 'application/json'
                    }
                });
            } catch (error) {
                console.log('Logout error (ignored):', error);
            }
            
            // –û—á–∏—â–∞–µ–º –¥–∞–Ω–Ω—ã–µ
            currentToken = '';
            currentUsername = '';
            localStorage.removeItem('bookTrackerToken');
            localStorage.removeItem('bookTrackerUsername');
            
            // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –Ω–∞ –≥–ª–∞–≤–Ω—É—é
            showWelcome();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
            alert('–í—ã –≤—ã—à–ª–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã');
        }
        
        // –§—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –∫–Ω–∏–≥
        async function loadBooks() {
            if (!currentToken) return;
            
            try {
                const response = await fetch(`${API_BASE}/books`, {
                    headers: { 'Authorization': `Bearer ${currentToken}` }
                });
                
                if (response.ok) {
                    const books = await response.json();
                    displayBooks(books);
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                    document.getElementById('books-count').textContent = `–ö–Ω–∏–≥: ${books.length}`;
                    
                    // –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
                    let totalPagesRead = 0;
                    for (const book of books) {
                        const progressResponse = await fetch(`${API_BASE}/books/${book.id}/progress`, {
                            headers: { 'Authorization': `Bearer ${currentToken}` }
                        });
                        if (progressResponse.ok) {
                            const progress = await progressResponse.json();
                            totalPagesRead += progress.current_page || 0;
                        }
                    }
                    document.getElementById('pages-read').textContent = `–ü—Ä–æ—á–∏—Ç–∞–Ω–æ —Å—Ç—Ä–∞–Ω–∏—Ü: ${totalPagesRead}`;
                }
            } catch (error) {
                console.error('Error loading books:', error);
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–Ω–∏–≥
        async function displayBooks(books) {
            const booksList = document.getElementById('books-list');
            
            if (books.length === 0) {
                booksList.innerHTML = '<p style="color: #7f8c8d; text-align: center; padding: 40px;">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∫–Ω–∏–≥. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—É—é!</p>';
                return;
            }
            
            let html = '';
            
            for (const book of books) {
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –¥–ª—è –∫–∞–∂–¥–æ–π –∫–Ω–∏–≥–∏
                let currentPage = 0;
                try {
                    const progressResponse = await fetch(`${API_BASE}/books/${book.id}/progress`, {
                        headers: { 'Authorization': `Bearer ${currentToken}` }
                    });
                    if (progressResponse.ok) {
                        const progress = await progressResponse.json();
                        currentPage = progress.current_page || 0;
                    }
                } catch (error) {
                    console.error('Error loading progress:', error);
                }
                
                const progressPercent = book.total_pages > 0 ? 
                    Math.min(100, Math.round((currentPage / book.total_pages) * 100)) : 0;
                
                html += `
                <div class="book-card">
                    <h3 style="color: #2c3e50; margin-bottom: 10px;">${book.title}</h3>
                    <p style="color: #7f8c8d; margin-bottom: 10px; font-style: italic;">${book.author}</p>
                    
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <div>
                            <span style="color: #3498db; font-weight: bold;">${currentPage}</span>
                            <span style="color: #95a5a6;"> / ${book.total_pages} —Å—Ç—Ä–∞–Ω–∏—Ü</span>
                        </div>
                        <span style="background: ${progressPercent === 100 ? '#2ecc71' : '#3498db'}; 
                               color: white; padding: 5px 10px; border-radius: 20px; font-size: 14px;">
                            ${progressPercent}%
                        </span>
                    </div>
                    
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${progressPercent}%"></div>
                    </div>
                    
                    <div style="margin-top: 15px; display: flex; gap: 10px;">
                        <input type="number" 
                               id="page-input-${book.id}" 
                               value="${currentPage}"
                               min="0" 
                               max="${book.total_pages}"
                               style="flex: 1; padding: 8px; border: 1px solid #ddd; border-radius: 5px;">
                        <button onclick="updateBookProgress(${book.id})" 
                                style="background: #3498db; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer;">
                            –û–±–Ω–æ–≤–∏—Ç—å
                        </button>
                    </div>
                </div>
                `;
            }
            
            booksList.innerHTML = html;
        }
        
        // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∫–Ω–∏–≥–∏
        async function updateBookProgress(bookId) {
            const pageInput = document.getElementById(`page-input-${bookId}`);
            const currentPage = parseInt(pageInput.value);
            
            if (isNaN(currentPage) || currentPage < 0) {
                alert('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —á–∏—Å–ª–æ —Å—Ç—Ä–∞–Ω–∏—Ü');
                return;
            }
            
            try {
                const response = await fetch(`${API_BASE}/books/${bookId}/progress`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${currentToken}`
                    },
                    body: JSON.stringify({ current_page: currentPage })
                });
                
                if (response.ok) {
                    loadBooks(); // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å–ø–∏—Å–æ–∫ –∫–Ω–∏–≥
                } else {
                    alert('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞');
                }
            } catch (error) {
                alert('–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É');
            }
        }
        
        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–Ω–∏–≥–∞–º–∏
        function showAddBookForm() {
            document.getElementById('add-book-modal').classList.remove('hidden');
        }
        
        function hideAddBookForm() {
            document.getElementById('add-book-modal').classList.add('hidden');
        }
        
        async function addNewBook() {
            const title = document.getElementById('new-book-title').value;
            const author = document.getElementById('new-book-author').value;
            const description = document.getElementById('new-book-description').value;
            const total_pages = parseInt(document.getElementById('new-book-pages').value);
            
            if (!title || !author || !total_pages || total_pages <= 0) {
                alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ');
                return;
            }
            
            try {
                const response = await fetch(`${API_BASE}/books`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${currentToken}`
                    },
                    body: JSON.stringify({ title, author, description, total_pages })
                });
                
                if (response.ok) {
                    hideAddBookForm();
                    loadBooks();
                    
                    // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
                    document.getElementById('new-book-title').value = '';
                    document.getElementById('new-book-author').value = '';
                    document.getElementById('new-book-description').value = '';
                    document.getElementById('new-book-pages').value = '';
                    
                    alert('–ö–Ω–∏–≥–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!');
                } else {
                    const data = await response.json();
                    alert(data.detail || '–û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–Ω–∏–≥–∏');
                }
            } catch (error) {
                alert('–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É');
            }
        }
        
        // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
        function showMessage(element, text, type = 'success') {
            element.textContent = text;
            element.className = `message ${type}`;
            element.classList.remove('hidden');
            
            setTimeout(() => {
                element.classList.add('hidden');
            }, 3000);
        }
    </script>
</body>
</html>